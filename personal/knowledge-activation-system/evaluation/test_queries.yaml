# KAS RAG Evaluation Test Queries
# Each query has expected characteristics for evaluation
#
# Scoring:
# - context_relevancy: Are retrieved chunks relevant to the query?
# - answer_relevancy: Does the answer address the query?
# - faithfulness: Is the answer grounded in the retrieved context?

queries:
  # =============================================================================
  # Framework Knowledge
  # =============================================================================
  - id: framework-001
    query: "How do I create a FastAPI dependency?"
    category: frameworks
    expected_keywords:
      - Depends
      - dependency injection
      - callable
    expected_namespaces:
      - frameworks
    difficulty: easy

  - id: framework-002
    query: "What is the difference between Pydantic v1 and v2?"
    category: frameworks
    expected_keywords:
      - pydantic
      - v2
      - migration
      - Config
    expected_namespaces:
      - frameworks
    difficulty: medium

  - id: framework-003
    query: "How does LangChain handle document loading?"
    category: frameworks
    expected_keywords:
      - DocumentLoader
      - load
      - Document
    expected_namespaces:
      - frameworks
    difficulty: medium

  # =============================================================================
  # RAG Knowledge
  # =============================================================================
  - id: rag-001
    query: "What is RAG and how does it work?"
    category: ai-ml
    expected_keywords:
      - retrieval
      - augmented
      - generation
      - context
    expected_namespaces:
      - ai-research
      - ai-ml
    difficulty: easy

  - id: rag-002
    query: "How do I evaluate RAG system quality?"
    category: ai-ml
    expected_keywords:
      - evaluation
      - faithfulness
      - relevancy
      - quality
    expected_namespaces:
      - ai-ml
      - projects
    difficulty: medium

  - id: rag-003
    query: "What are hybrid search strategies for RAG?"
    category: ai-ml
    expected_keywords:
      - BM25
      - vector
      - semantic
      - fusion
    expected_namespaces:
      - ai-ml
      - frameworks
    difficulty: medium

  # =============================================================================
  # Agent Knowledge
  # =============================================================================
  - id: agent-001
    query: "How do I implement tool use with Claude?"
    category: agents
    expected_keywords:
      - tool
      - function
      - anthropic
    expected_namespaces:
      - agent-frameworks
      - best-practices
    difficulty: easy

  - id: agent-002
    query: "What is the ReAct pattern for agents?"
    category: agents
    expected_keywords:
      - reason
      - action
      - observation
      - loop
    expected_namespaces:
      - agent-frameworks
      - ai-research
    difficulty: medium

  - id: agent-003
    query: "How does LangGraph handle state in agents?"
    category: agents
    expected_keywords:
      - state
      - graph
      - node
      - edge
    expected_namespaces:
      - agent-frameworks
    difficulty: hard

  # =============================================================================
  # Infrastructure Knowledge
  # =============================================================================
  - id: infra-001
    query: "How do I deploy a Docker container?"
    category: infrastructure
    expected_keywords:
      - docker
      - container
      - run
      - image
    expected_namespaces:
      - infrastructure
      - tools
    difficulty: easy

  - id: infra-002
    query: "What is Kubernetes pod scheduling?"
    category: infrastructure
    expected_keywords:
      - pod
      - node
      - scheduler
      - affinity
    expected_namespaces:
      - infrastructure
    difficulty: medium

  # =============================================================================
  # MCP Knowledge
  # =============================================================================
  - id: mcp-001
    query: "What is the Model Context Protocol?"
    category: mcp
    expected_keywords:
      - MCP
      - server
      - tool
      - protocol
    expected_namespaces:
      - tools
      - projects/mcp-servers
    difficulty: easy

  - id: mcp-002
    query: "How do I create an MCP server?"
    category: mcp
    expected_keywords:
      - server
      - tool
      - handler
      - stdio
    expected_namespaces:
      - projects/mcp-servers
      - tools
    difficulty: medium

  # =============================================================================
  # Best Practices
  # =============================================================================
  - id: best-001
    query: "What are prompt engineering best practices?"
    category: best-practices
    expected_keywords:
      - prompt
      - chain-of-thought
      - few-shot
    expected_namespaces:
      - best-practices
    difficulty: easy

  - id: best-002
    query: "How do I secure an LLM application?"
    category: best-practices
    expected_keywords:
      - security
      - LLM
      - OWASP
      - prompt
    expected_namespaces:
      - reference
      - best-practices
    difficulty: medium

  # =============================================================================
  # Edge Cases / Challenging
  # =============================================================================
  - id: edge-001
    query: "What embedding models work best with Ollama?"
    category: tools
    expected_keywords:
      - nomic
      - embed
      - ollama
    expected_namespaces:
      - tools
      - ai-ml
    difficulty: hard

  - id: edge-002
    query: "How do I implement streaming with FastAPI and LLMs?"
    category: frameworks
    expected_keywords:
      - streaming
      - SSE
      - async
      - yield
    expected_namespaces:
      - frameworks
    difficulty: hard

  - id: edge-003
    query: "What is the FSRS algorithm for spaced repetition?"
    category: learning
    expected_keywords:
      - FSRS
      - spaced
      - repetition
      - memory
    expected_namespaces: []  # May not have content
    difficulty: hard
    notes: "Test case for missing knowledge"

  # =============================================================================
  # Additional Edge Cases (Abbreviations & Acronyms)
  # =============================================================================
  - id: edge-004
    query: "How does k8s handle pod autoscaling?"
    category: infrastructure
    expected_keywords:
      - kubernetes
      - HPA
      - scale
      - replicas
    expected_namespaces:
      - infrastructure
    difficulty: medium
    notes: "Tests k8s -> kubernetes expansion"

  - id: edge-005
    query: "What is CI/CD best practice?"
    category: devops
    expected_keywords:
      - continuous
      - integration
      - deployment
      - pipeline
    expected_namespaces:
      - infrastructure
      - best-practices
    difficulty: easy
    notes: "Tests CI/CD abbreviation"

  - id: edge-006
    query: "pg vector similarity search"
    category: databases
    expected_keywords:
      - postgresql
      - pgvector
      - cosine
      - similarity
    expected_namespaces:
      - infrastructure
      - ai-ml
    difficulty: medium
    notes: "Tests pg -> postgresql expansion"

  # =============================================================================
  # Multi-word Phrase Queries
  # =============================================================================
  - id: phrase-001
    query: "chain of thought prompting examples"
    category: ai-ml
    expected_keywords:
      - chain-of-thought
      - reasoning
      - step by step
    expected_namespaces:
      - best-practices
      - ai-ml
    difficulty: medium

  - id: phrase-002
    query: "dependency injection in Python"
    category: frameworks
    expected_keywords:
      - dependency
      - injection
      - Depends
      - FastAPI
    expected_namespaces:
      - frameworks
    difficulty: easy

  - id: phrase-003
    query: "async await best practices Python"
    category: frameworks
    expected_keywords:
      - async
      - await
      - asyncio
      - concurrent
    expected_namespaces:
      - frameworks
      - best-practices
    difficulty: medium

  # =============================================================================
  # Natural Language Queries
  # =============================================================================
  - id: natural-001
    query: "why is my API returning 422 errors?"
    category: debugging
    expected_keywords:
      - validation
      - pydantic
      - request
      - schema
    expected_namespaces:
      - frameworks
    difficulty: medium
    notes: "Natural language error debugging"

  - id: natural-002
    query: "how do I make my search faster?"
    category: optimization
    expected_keywords:
      - index
      - cache
      - performance
      - query
    expected_namespaces:
      - infrastructure
      - best-practices
    difficulty: medium
    notes: "Vague optimization query"

  - id: natural-003
    query: "what's the difference between embedding and fine-tuning?"
    category: ai-ml
    expected_keywords:
      - embedding
      - fine-tuning
      - model
      - training
    expected_namespaces:
      - ai-ml
    difficulty: medium

  # =============================================================================
  # Code-specific Queries
  # =============================================================================
  - id: code-001
    query: "FastAPI @app.get decorator"
    category: frameworks
    expected_keywords:
      - route
      - endpoint
      - decorator
      - HTTP
    expected_namespaces:
      - frameworks
    difficulty: easy

  - id: code-002
    query: "SQLAlchemy async session"
    category: databases
    expected_keywords:
      - session
      - async
      - engine
      - connection
    expected_namespaces:
      - frameworks
      - infrastructure
    difficulty: medium

  - id: code-003
    query: "React useEffect cleanup"
    category: frameworks
    expected_keywords:
      - useEffect
      - cleanup
      - return
      - unmount
    expected_namespaces:
      - frameworks
    difficulty: easy

# Evaluation settings
settings:
  default_limit: 5
  min_confidence: 0.3
  required_keyword_overlap: 0.5  # At least 50% of keywords should appear
