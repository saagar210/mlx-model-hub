{{- if not .Values.auth.existingSecret }}
apiVersion: v1
kind: Secret
metadata:
  name: langfuse-auth
  namespace: {{ .Values.namespace }}
  labels:
    app.kubernetes.io/name: langfuse
    app.kubernetes.io/component: auth
type: Opaque
stringData:
  NEXTAUTH_SECRET: {{ .Values.auth.nextauthSecret | quote }}
  SALT: {{ .Values.auth.salt | quote }}
  ENCRYPTION_KEY: {{ .Values.auth.nextauthSecret | b64enc | trunc 32 | quote }}
{{- end }}
---
{{- if .Values.postgresql.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: langfuse-postgresql
  namespace: {{ .Values.namespace }}
  labels:
    app.kubernetes.io/name: langfuse
    app.kubernetes.io/component: postgresql
type: Opaque
stringData:
  POSTGRES_PASSWORD: {{ .Values.postgresql.auth.password | quote }}
  DATABASE_URL: "postgresql://{{ .Values.postgresql.auth.username }}:{{ .Values.postgresql.auth.password }}@langfuse-postgresql:5432/{{ .Values.postgresql.auth.database }}"
{{- end }}
---
{{- if .Values.clickhouse.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: langfuse-clickhouse
  namespace: {{ .Values.namespace }}
  labels:
    app.kubernetes.io/name: langfuse
    app.kubernetes.io/component: clickhouse
type: Opaque
stringData:
  CLICKHOUSE_USER: default
  CLICKHOUSE_PASSWORD: ""
  CLICKHOUSE_URL: "http://langfuse-clickhouse:8123"
{{- end }}
